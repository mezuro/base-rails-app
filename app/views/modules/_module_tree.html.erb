<p>
  <strong>Name:</strong>
  <%= format_module_name(@root_module_result.kalibro_module.name) %>
</p>
<p>
  <strong>Granularity:</strong>
  <%= @root_module_result.kalibro_module.granularity %>
</p>
<p>
  <strong>Grade:</strong>
  <%= format_grade(@root_module_result.grade) %>
</p>
<% unless @root_module_result.parent_id.nil? %>
  <p id="parent"><i class="icon-arrow-up"></i><%= link_to '../', '#parent', onClick: "Module.Tree.load('#{escape_javascript(image_tag 'loader.gif')} Loading data. Please, wait.', #{@root_module_result.parent_id});" %></p>
<% end %>

<% cache("#{@root_module_result.id}_tree") do %>
  <% children = @root_module_result.children.sort do %>
      <% |a,b| (a.module.granularity == b.module.granularity) ? a.module.name <=> b.module.name : -a.module.granularity.length <=> -b.module.granularity.length %>
  <% end %>
  <% unless children.empty? %>
    <table class="table table-hover">
      <thead>
        <th>Name</th>
        <th>Granularity</th>
        <th>Grade</th>
      </thead>
      <tbody>
        <%= render partial: 'module_result', collection: children %>
      </tbody>
    </table>
  <% end %>
<% end %>
